<!-- permissions used twice - Users, Roles but different in create roles-->

    <% perms = (Permission.all.group_by &:subject_class) %>
     <table border="0" cellpadding="0" cellspacing="0" width="100%">
     <% r = perms.keys %>
     <% defs = ["Enquiry","Registration","Institution","Person"] %>
     <% r = r - ["All","Country","City"] %>

     <% defs.each do |model| %>
    
          <tr colspan="5">
          <td>
          <h6>
          <%= model %>
          </h6>
          </td>
          
          
          <% perms[model].each do |p| %>
            <td>
                    <%= check_box_tag "#{f}[permission_ids][]",
                                                                      p.id, 
                                                                      role.permissions.include?(p) %>
                    <%= label_tag(:permissions, p.action.titleize)%>
            </td>
         <% end %>
         </tr>
   
    <% end %>
    <tr>
    <td colspan="6">
    <a class="toggler" onclick="$('.more_permissions').slideToggle(); $('#perm_save_1').slideToggle();"> more </a>
    </td>
    </tr>
     </table>
     <table  class="tables3 more_permissions" border="0" cellpadding="0" cellspacing="0" width="100%"  style="display:none;">
               <tr>
               <td></td>
               <% ["Create","Read","Update","Delete"].each do |i| %>
               <td><%= check_box_tag "permissions_col",
                                         nil,
                                         nil,
                                         {id: "col_check",
                                         checked: false,
                                         onclick: "toggleAllCheckCol(this);"} %>
                <label> <%= i %> </label>
               </td>
               <% end %>
               </tr>
               <% (r - (defs + ["User"])).each do |model| %>
                
                      <tr>
                      <td>
                      <h6>
                     
                      <span class="fl padr10">
                      <%= check_box_tag "permissions_row",
                                         nil,
                                         nil,
                                         {id: "row_check",
                                         checked: false,
                                         onclick: "toggleAllCheckRow(this);"} %>
                      
                      </span>
                       <%= model %>
                      </h6>
                      </td>
                      <% perms[model].each do |p| %>
                        <td align="left">
                                <%= check_box_tag "#{f}[permission_ids][]",
                                                   p.id, 
                                                   role.permissions.include?(p),{class: "permissions"} %>
                        </td>
                      <% end %>
                     </tr>
                <% end %>
    </table>
